<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<title>Allgemeine Modelleinstellungen</title>

<link href="book.css" rel="stylesheet" type="text/css">
<link href="code.css" rel="stylesheet" type="text/css">
<link rel="home" href="documentation.html" title="">
</head>
<body>
<a name="AllgemeineModelleinstellungen"></a>
<h1>Allgemeine Modelleinstellungen</h1>
<p>
In der Modelldatei wird als erstes Kommando die Applikation beschrieben. Die Syntax lautet:
</p>
<p>
<span class="inlinecode"><span class="keyword">application</span>&nbsp;&lt;Name&gt;&nbsp;<span class="keyword">context</span>&nbsp;&lt;Context-Path&gt;&nbsp;<span class="keyword">package</span>&nbsp;&lt;Package-Id&gt;&nbsp;(<span class="keyword">timeout</span>&nbsp;&lt;Timeout-Minutes&gt;)&nbsp;(&lt;Project-State&gt;)&nbsp;(<span class="keyword">strict</span>);</span>
</p>
<p>
Der Name ist ein String, der im Klartext die Applikation beschreibt. Der Context-Path ist ein String, der den Applikationskontext
festlegt. Dieser muss zwingend mit einem Schrägstrich "/" beginnen. Es ist der erste Teil der URI.
</p>
<p>
Optional kann der Session Timeout in Minuten festgelegt werden. Wird dieser nicht definiert, wird der Default des Application Servers
verwendet. Üblicherweise beträgt dieser Wert 30 Minuten. Als project-state können die drei Schlüsselwörter <span class="inlinecode"><span class="keyword">development</span></span>,
<span class="inlinecode"><span class="keyword">integration</span></span> und <span class="inlinecode"><span class="keyword">productive</span></span> dienen und beschreiben den Zustand des Projektes. Abhängig davon wird z.B. 
das Logging entsprechend verschärft.
</p>
<p>
<table>
<tr>
<td>
</td>
<td>
<em>Datei</em>
</td>
<td>
<span class="inlinecode"><span class="keyword">development</span></span>
</td>
<td>
<span class="inlinecode"><span class="keyword">integration</span></span>
</td>
<td>
<span class="inlinecode"><span class="keyword">productive</span></span>
</td>
</tr>
<tr>
<td>
Logging Level
</td>
<td>
<em>src-gen/&lt;package&gt;/log4j.properties</em>
</td>
<td>
DEBUG
</td>
<td>
DEBUG
</td>
<td>
INFO
</td>
</tr>
<tr>
<td>
Property hibernate.show_sql
</td>
<td>
<em>res-gen/WEB-INF/classes/META-INF/persistence.xml</em>
</td>
<td>
true
</td>
<td>
false
</td>
<td>
false
</td>
</tr>
<tr>
<td>
Property eclipselink.logging.level
</td>
<td>
<em>res-gen/WEB-INF/classes/META-INF/persistence.xml</em>
</td>
<td>
DEBUG
</td>
<td>
INFO
</td>
<td>
INFO
</td>
</tr>
<tr>
<td>
&lt;context-param&gt; javax.faces.PROJECT_STAGE
</td>
<td>
<em>res-gen/WEB-INF/web.xml</em>
</td>
<td>
Development
</td>
<td>
SystemTest
</td>
<td>
Productive
</td>
</tr>
</table>
</p>
<p>
Als letztes optionales Schlüsselwort dient <span class="inlinecode"><span class="keyword">strict</span></span>. Es entscheidet, ob in den Basisklassen der Action Handler die Standardmethoden
abstrakt vordefiniert werden und somit in den konkreten Klassen vorhanden sein müssen. Dadurch wird einerseits der Code besser, 
allerdings kann es vorkommen, dass die geforderten Methoden tatsächlich nicht gebraucht werden. Das kann aber nur bei starker 
Anpassung der XHTML-Masken passieren.
</p>
<p>
Nach dem <span class="inlinecode"><span class="keyword">application</span></span>-Kommando werden Optionen festgelegt, die das Verhalten der Web-Applikation näher beschreiben. Danach folgen 
die Beschreibungen der Entity Beans, welche auf einer <a href="Entity%20Beans.html#EntityBeans" title="Go to &quot;Entity Beans&quot;">eigenen Seite genauer beschrieben werden</a> und zuletzt die Aufgaben- bzw. 
Prozess-Umgebungen, in denen die Entity Beans benutzt werden sollen.
</p>
<a name="Applikationsoptionen"></a>
<h2>Applikationsoptionen</h2>
<p>
Die Applikationsoptionen beschreiben die Web Applikation näher. Sie beeinflussen folgende Eigenschaften:
<ol>
	<li>
		Persistenz Kontexte
	</li>
	<li>
		Verwendete Sprachen (Lokalisierung)
	</li>
	<li>
		Mail
	</li>
	<li>
		Security Domains
	</li>
	<li>
		Parameter
	</li>
</ol>
</p>
<a name="PersistenzKontexte"></a>
<h3>Persistenz Kontexte</h3>
<p>
Der JEE6-Generator unterstützt mehrere Persistenz Kontexte in einer Applikation. Das setzt voraus, dass in diesem Falle die
Datasources als XA-Datasource im Application Server konfiguriert sind. Die Syntax lautet:
</p>
<p>
<span class="inlinecode"><span class="keyword">persistence</span>&nbsp;<span class="keyword">unit</span>&nbsp;&lt;Unit-Name&gt;&nbsp;<span class="keyword">jndi</span>&nbsp;&lt;Jndi-Name&gt;&nbsp;(<span class="keyword">cacheable</span>)&nbsp;(MySQL|DB2|Oracle);</span>
</p>
<p>
Der unit-name wird in der persistence.xml als Referenz innerhalb der Web Applikation verwendet. Der JNDI-Name definiert, wie die
Datasource im Application Server wiederzufinden ist. Eine eingehende Beschreibung, wie der JDNI-Name lauten sollte, findet sich auf
diesen Seiten. Wird das optionale Schlüsselwort cacheable verwendet, wird die Persistence Unit als Second Level Cache konfiguriert.
</p>
<p>
<em>Hinweis</em>
Es reicht nicht, nur das cacheable Schlüsselwort zu setzen, um im Application Server Second Level Caching zu aktivieren. Es müssen
meistens noch am Application Server selbst noch Konfigurationen vorgenommen werden.
</p>
<p>
Es werden die Datenbanken
<ul>
	<li>
		MySQL (Default)
	</li>
	<li>
		DB2
	</li>
	<li>
		Oracle
	</li>
</ul>

unterstützt. Die Angabe wird nötig, um in der generierten Datei persistence.xml den SQL-Sprachdialekt festzulegen.
</p>
<a name="VerwendeteSprachen"></a>
<h3>Verwendete Sprachen (Lokalisierung)</h3>
<p>
In mehrsprachigen Umgebungen ist die Lokalisierung der Applikation immer wünschenswert. Der JEE6-Generator hat für alle Komponenten
eine entsprechende Unterstützung parat. Die Auswahl der Sprache selbst wird typischerweise im Browser eingestellt. Die Web Applikation
erfährt das dadurch, dass die im Browser eingestellte Sprache im Request mitgeschickt wird. Die Lokalisierung wird über sog. Resource
Bundles vorgenommen. Diese werden in den XHTML-Seiten eingebunden. Für jedes Attribut, Entity Bean, etc. werden die dafür benötigten
Einträge in die Resource Bundles nachgetragen, sofern sie noch nicht enthalten sind. Bereits bestehende Einträge werden nicht
verändert. An dieser Stelle wird beschrieben, wie in der Modelldatei konfiguriert wird, welche Sprachen unterstützt werden sollen.
Die Syntax lautet:
</p>
<p>
<span class="inlinecode"><span class="keyword">locale</span>&nbsp;&lt;Language&gt;&nbsp;(&lt;Country&gt;)&nbsp;(<span class="keyword">default</span>);</span>
</p>
<p>
Die <em>language</em> ist der ISO-Code der zu verwendenden Sprache und hat typischerweise kleine Buchstaben. Der optionale Wert <em>country</em>
bestimmt die ISO-Länderkennung typischerweise in Großbuchstaben. Dadurch werden landestypische Sprachvarianten unterschieden.
</p>
<p>
<em>Hinweis!</em>
Es muss mindestens eine Locale-Definition vorhanden sein und genau eine braucht das ansonsten optionale Schlüsselwort default. Diese
Sprache wird verwendet, falls die im Browser eingestellte Sprache in den Resource Bundles nicht gefunden werden konnte.
</p>
<a name="EMail"></a>
<h3>E-Mail</h3>
<p>
Will die Web Applikation E-Mail verschicken, muss einerseits der Mail-Versand im Application Server konfiguriert sein, und
andererseits hier im Model eingetragen werden, unter welchem JDNI-Namen der Mailservice erreichbar ist. Dazu dient die einfache Syntax:
</p>
<p>
<span class="inlinecode"><span class="keyword">smtp</span>&nbsp;&lt;Jndi-Name&gt;;</span>
</p>
<p>
Mehr Information zum Thema Mail im JEE-Umfeld befinden sich auf diesen Seiten. Die auf diesen Seiten beschriebenen Einträge in den
genannten XML-Deskriptoren werden vom JEE6-Generator automatisch erzeugt. Die Resource muss manuell in dem DAO eingetragen werden,
in dem Mailing verwendet werden soll. Das dazugehörige Code-Schnipsel sieht folgendermaßen aus:
</p>
<p>
<div class="literallayout">
<div class="incode">
<p class="code">
@Resource(name=<span class="string">"&lt;jndi-name&gt;"</span>)<br/>
<span class="keyword">private</span>&nbsp;javax.mail.Session&nbsp;mailSession;
</p>
</div>
</div>
</p>
<p>
Wird für <em>jndi-name</em> "mail/Default" verwendet, muss im JBoss Application Server nichts mehr konfiguriert werden.
</p>
<a name="SecurityDomain"></a>
<h3>Security Domain</h3>
<p>
Sollen nur bestimmte User für bestimmte Bereiche (in der JEE6-Generator-Nomenklatur "Prozesse") Zugang haben, so muss eine sog.
Security Domain über einen JNDI-Namen referenziert werden. Dieser muss dementsprechen wie die E-Mail im Application Server
konfiguriert sein und benutzt den JAAS-Standard. Auf diesen Seiten befinden sich Informationen über die Konfiguration von JAAS.
Die Syntax lautet:
</p>
<p>
<span class="inlinecode"><span class="keyword">security</span>&nbsp;<span class="keyword">domain</span>&nbsp;&lt;Jndi-Name&gt;&nbsp;(<span class="keyword">clustered</span>);</span>
</p>
<p>
Das optionale Schlüsselwort <span class="inlinecode"><span class="keyword">clustered</span></span> bestimt, ob die Security Domain in einer geclusterten Umgebung funktionsfähig
sein muss.
</p>
<a name="WebParameter"></a>
<h3>Web Parameter</h3>
<p>
Mit Web-Parametern kann man der Web Applikation in der web.xml Parameter übergeben. Die Syntax lautet:
</p>
<p>
<span class="inlinecode"><span class="keyword">param</span>&nbsp;&lt;Key&gt;&nbsp;=&nbsp;&lt;Value&gt;&nbsp;(<span class="keyword">description</span>&nbsp;&lt;Description&gt;);</span>
</p>
<p>
Die Einträge können beliebig häufig im Modell eingetragen werden. Aus folgender Modellzeile:
<span class="inlinecode"><span class="keyword">param</span>&nbsp;de.itemis.purchasing.ITEMIKER&nbsp;=&nbsp;<span class="string">"itemis"</span>&nbsp;<span class="keyword">description</span>&nbsp;<span class="string">"LDAP-Gruppe&nbsp;aller&nbsp;itemiker"</span>;</span>
wird in der web.xml:
<div class="literallayout">
<div class="incode">
<p class="code">
&lt;context-param&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;LDAP-Gruppe&nbsp;aller&nbsp;itemiker&lt;/description&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-name&gt;de.itemis.purchasing.ITEMIKER&lt;/param-name&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-value&gt;itemis&lt;/param-value&gt;<br/>
&lt;/context-param&gt;
</p>
</div>
</div>
</p>
<p>
Mit der Methode String getInitParameter(final String key) in einem Action Handler kann auf diesen Wert zugegriffen werden. Die Werte
sind aus Sicht des Application Servers und der Applikation selbst nicht veränderlich.
</p>
</body>
</html>
